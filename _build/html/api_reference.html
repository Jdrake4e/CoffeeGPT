<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>API Reference &#8212; CoffeeGPT 1.5.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=56c4699f" />
    <script src="_static/documentation_options.js?v=1cd648e3"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Usage" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<section id="module-feature_selection">
<span id="feature-selection"></span><h2>Feature Selection<a class="headerlink" href="#module-feature_selection" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="feature_selection.granger_feature_selector">
<span class="sig-prename descclassname"><span class="pre">feature_selection.</span></span><span class="sig-name descname"><span class="pre">granger_feature_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframes_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection.html#granger_feature_selector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#feature_selection.granger_feature_selector" title="Link to this definition">¶</a></dt>
<dd><p>Perform Granger causality tests to select predictive features from time series data.</p>
<p>This function identifies features across multiple dataframes that have statistically
significant predictive power for a target variable (futures prices) using Granger
causality testing. It handles annual and monthly data aggregation and employs robust
error handling to ensure feature selection even with inconsistent data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframes_dict</strong> (<em>dict</em>) – Dictionary of dataframes to analyze. Must include a ‘futures’ dataframe
containing the target price variable. Other entries can be either dataframes
or dictionaries of dataframes.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Significance level threshold for p-values, by default 0.05.
Features with p-values below this threshold are considered significant.</p></li>
<li><p><strong>f_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum F-statistic threshold, by default 4.0.
Features must exceed this F-statistic value to be selected.</p></li>
<li><p><strong>min_lag</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum lag to consider for causality, by default 1.
Represents the minimum time delay for potential causal effects.</p></li>
<li><p><strong>max_lag</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum lag to consider for causality, by default 7.
Represents the maximum time delay for potential causal effects.</p></li>
<li><p><strong>monthly_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the data is monthly (True) or yearly (False), by default False.
Affects column naming and aggregation approaches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of unique selected feature column names across all dataframes that
meet the Granger causality criteria for predicting futures prices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<section id="data-preparation-and-structure">
<h3>1. Data Preparation and Structure<a class="headerlink" href="#data-preparation-and-structure" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>1.1. Target Variable Handling</dt><dd><ul class="simple">
<li><p>For yearly data: Uses ‘Price’ column as the target variable</p></li>
<li><p>For monthly data: Uses ‘Price_mean’ column as the target variable</p></li>
<li><p>Target is aggregated by year to enable time series causality testing</p></li>
</ul>
</dd>
<dt>1.2. Input Data Structure Requirements</dt><dd><ul class="simple">
<li><p>The ‘futures’ dataframe must contain the target price variable</p></li>
<li><p>All dataframes should contain a ‘Date’ column for time alignment</p></li>
<li><p>Can accept nested dictionaries of dataframes for hierarchical data</p></li>
</ul>
</dd>
</dl>
</section>
<section id="processing-and-analysis-flow">
<h3>2. Processing and Analysis Flow<a class="headerlink" href="#processing-and-analysis-flow" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>2.1. Output Suppression</dt><dd><ul class="simple">
<li><p>All standard output is redirected to devnull during execution</p></li>
<li><p>Prevents verbose output from statsmodels during testing</p></li>
</ul>
</dd>
<dt>2.2. Target Data Preparation</dt><dd><ul class="simple">
<li><p>Futures dataframe is extracted and processed</p></li>
<li><p>Dates are converted to datetime objects</p></li>
<li><p>Data is aggregated by year for consistent time series analysis</p></li>
</ul>
</dd>
<dt>2.3. Feature Dataframe Processing</dt><dd><ul class="simple">
<li><p>Each dataframe except ‘futures’ is processed individually</p></li>
<li><p>Handles both single dataframes and nested dictionaries</p></li>
<li><p>Maintains ‘Date’ column for all dataframes by default</p></li>
</ul>
</dd>
<dt>2.4. Feature Selection Procedure</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>For each numerical column in each dataframe:</dt><dd><ol class="loweralpha simple">
<li><p>Data is aggregated yearly</p></li>
<li><p>Merged with target data on year</p></li>
<li><p>Granger causality tests performed for lags min_lag to max_lag</p></li>
<li><p>Features selected if they meet both p-value and F-statistic criteria</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>For selected features, corresponding “_was_nan” columns are also included</p></li>
</ul>
</dd>
</dl>
</section>
<section id="error-handling-and-robustness">
<h3>3. Error Handling and Robustness<a class="headerlink" href="#error-handling-and-robustness" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>3.1. Exception Management</dt><dd><ul class="simple">
<li><p>Individual dataframe processing errors are caught and handled</p></li>
<li><p>Ensures the function continues even if some dataframes cause errors</p></li>
<li><p>Defaults to including only ‘Date’ column if a dataframe fails processing</p></li>
</ul>
</dd>
<dt>3.2. Data Sufficiency Check</dt><dd><ul class="simple">
<li><p>Skips analysis for merged datasets with insufficient time points</p></li>
<li><p>Requires at least max_lag + 2 observations for valid causality testing</p></li>
</ul>
</dd>
</dl>
</section>
<section id="output-generation">
<h3>4. Output Generation<a class="headerlink" href="#output-generation" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>4.1. Default Inclusions</dt><dd><ul class="simple">
<li><p>For non-monthly data: ‘Date’ and ‘Price’ from futures are always included</p></li>
<li><p>For monthly data: Price statistics (mean, median, min, max) are included</p></li>
</ul>
</dd>
<dt>4.2. Feature Deduplication</dt><dd><ul class="simple">
<li><p>Returns a list of unique features to avoid redundancy</p></li>
<li><p>Converts set back to list for consistent output format</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with yearly data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;futures&#39;</span><span class="p">:</span> <span class="n">df_futures</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;economic_indicators&#39;</span><span class="p">:</span> <span class="n">df_econ</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;weather_data&#39;</span><span class="p">:</span> <span class="n">df_weather</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_features</span> <span class="o">=</span> <span class="n">granger_feature_selector</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dfs</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">f_threshold</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">max_lag</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected features: </span><span class="si">{</span><span class="n">selected_features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="feature_selection.suppress_output">
<span class="sig-prename descclassname"><span class="pre">feature_selection.</span></span><span class="sig-name descname"><span class="pre">suppress_output</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection.html#suppress_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#feature_selection.suppress_output" title="Link to this definition">¶</a></dt>
<dd><p>Context manager to redirect stdout and stderr to devnull.</p>
<p>Temporarily suppresses all standard output during execution of the wrapped
code and restores it afterward.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>file object</em> – The devnull file object that stdout is redirected to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="feature_selection.wrapped_granger_causality_test">
<span class="sig-prename descclassname"><span class="pre">feature_selection.</span></span><span class="sig-name descname"><span class="pre">wrapped_granger_causality_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection.html#wrapped_granger_causality_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#feature_selection.wrapped_granger_causality_test" title="Link to this definition">¶</a></dt>
<dd><p>Test for Granger causality between time series variables.</p>
<p>This function implements a robust Granger causality test to determine whether
past values of one time series (feature) help predict future values of another
time series (target) better than the target’s past values alone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>pandas.Series</em>) – The target time series variable to be predicted.</p></li>
<li><p><strong>feature</strong> (<em>pandas.Series</em>) – The feature time series variable to test for causal relationship.</p></li>
<li><p><strong>maxlag</strong> (<em>int</em>) – Maximum number of lags to test for causality.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>List of dictionaries containing test results for each lag, with keys:</p>
<ul class="simple">
<li><dl class="simple">
<dt>’Lag’<span class="classifier">int</span></dt><dd><p>The lag order for this test</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’F-Statistic’<span class="classifier">float</span></dt><dd><p>The F-statistic value for this lag</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’p-value’<span class="classifier">float</span></dt><dd><p>The p-value for this lag’s test</p>
</dd>
</dl>
</li>
</ul>
<p>Returns an empty list if the test fails.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:</p>
<ol class="arabic simple">
<li><p>Statistical Framework:
- Uses F-test based on sum of squared residuals
- Tests null hypothesis of no Granger causality
- Implements multiple lag testing for robustness</p></li>
<li><p>Data Handling:
- Removes missing values before testing
- Preserves time series ordering
- Handles non-stationary data gracefully</p></li>
<li><p>Error Management:
- Silent error handling to prevent pipeline breaks
- Returns empty list instead of raising exceptions
- Allows for batch processing of multiple tests</p></li>
<li><p>Performance:
- Efficient implementation using statsmodels
- Minimizes memory usage in results storage
- Suitable for large-scale feature selection</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>The test assumes linear relationships between variables</p></li>
<li><p>Results may be misleading for non-stationary time series</p></li>
<li><p>Small sample sizes may affect test reliability</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.tsa.stattools.grangercausalitytests</span></code></dt><dd><p>Core testing function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">feature_selection_pipeline</span></code></dt><dd><p>Main pipeline using this test</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">110</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">wrapped_granger_causality_test</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">maxlag</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lag </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;Lag&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: p=</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;p-value&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-file_readin_functions">
<span id="file-read-in-functions"></span><h2>File Read-in Functions<a class="headerlink" href="#module-file_readin_functions" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.OECD_forex_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">OECD_forex_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/OECD.SDD.NAD,DSD_NAMAIN10&#64;DF_TABLE4,1.0,filtered,2024-03-04</span> <span class="pre">17-04-58.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#OECD_forex_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.OECD_forex_readin" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.OECD_global_demographics_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">OECD_global_demographics_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/OECD.ELS.SAE,DSD_POPULATION&#64;DF_POP_HIST,1.0+..PS.F+M...csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#OECD_global_demographics_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.OECD_global_demographics_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process OECD global demographic data from a CSV file.</p>
<p>This function reads OECD demographic data, processes it into a time series format,
and handles multiple demographic indicators across countries. It performs data
transformation to create a structured demographic dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/OECD.ELS.SAE</em><em>,</em><em>DSD_POPULATION&#64;DF_POP_HIST</em><em>,</em><em>1.0+..PS.F+M</em><em>...</em><em>csv&quot;</em>) – Path to the CSV file containing OECD demographic data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Demographic indicators as columns
- Values representing population metrics over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Processing:</p>
<blockquote>
<div><ul class="simple">
<li><p>Handles OECD’s specific data format</p></li>
<li><p>Processes demographic indicators</p></li>
<li><p>Maintains country-specific information</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Time Series Handling:
- Converts OECD date format to standard datetime
- Creates consistent time series structure
- Handles periodic data points</p></li>
<li><p>Data Organization:
- Structures data by demographic indicators
- Preserves country-level granularity
- Maintains data relationships</p></li>
<li><p>Quality Control:
- Validates demographic data
- Handles missing values appropriately
- Ensures data consistency</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read demographic data from default file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">demo_data</span> <span class="o">=</span> <span class="n">OECD_global_demographics_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">demo_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows available demographic indicators</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">OECD_global_demographics_readin</span><span class="p">(</span><span class="s2">&quot;path/to/demo_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.UN_green_coffee_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">UN_green_coffee_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/UN</span> <span class="pre">Green</span> <span class="pre">Coffee</span> <span class="pre">Production.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/green_coffee_prod_iso3.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#UN_green_coffee_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.UN_green_coffee_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process UN green coffee production data from CSV files.</p>
<p>This function reads UN coffee production data and optionally combines it with ISO3
country codes. It processes the data into a time series format and handles multiple
coffee production indicators across countries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file1</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/UN Green Coffee Production.csv&quot;</em>) – Path to the CSV file containing UN green coffee production data.</p></li>
<li><p><strong>file2</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/green_coffee_prod_iso3.csv&quot;</em>) – Path to the CSV file containing ISO3 country codes mapping.</p></li>
<li><p><strong>add_iso</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to add ISO3 country codes to the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Coffee production indicators as columns
- Optional ISO3 country codes
- Values representing coffee production metrics over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Integration:</p>
<blockquote>
<div><ul class="simple">
<li><p>Optional ISO3 code integration</p></li>
<li><p>Handles country name variations</p></li>
<li><p>Maintains data integrity during merging</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Time Series Processing:
- Converts production periods to datetime
- Creates consistent time series structure
- Handles seasonal production data</p></li>
<li><p>Data Organization:
- Structures by production indicators
- Preserves country-level granularity
- Maintains production relationships</p></li>
<li><p>Quality Control:
- Validates production data
- Handles missing values appropriately
- Ensures data consistency</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read coffee data without ISO3 codes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coffee_data</span> <span class="o">=</span> <span class="n">UN_green_coffee_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">coffee_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows available production indicators</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read data with ISO3 codes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coffee_data_iso</span> <span class="o">=</span> <span class="n">UN_green_coffee_readin</span><span class="p">(</span><span class="n">add_iso</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">coffee_data_iso</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.all_csv_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">all_csv_readin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#all_csv_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.all_csv_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and combine all available CSV datasets into a unified data structure.</p>
<p>This function serves as a central coordinator for reading all available datasets,
including climate disasters, forest carbon, human development, land cover,
forex data, green coffee production, and futures data. It organizes these
datasets into a structured dictionary for easy access.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing all processed datasets with the following keys:
- ‘disaster’: Climate-related disaster frequency data
- ‘forest’: Forest and carbon data
- ‘hdi’: Human Development Index data
- ‘land’: Land cover account data
- ‘forex’: OECD forex data
- ‘green_coffee’: UN green coffee production data
- ‘futures’: Coffee futures market data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl>
<dt>Design Decisions:</dt><dd><p>1. Data Organization:
- Maintains separate datasets in dictionary format
- Preserves individual dataset structures
- Enables easy access to specific data types</p>
<p>2. Error Handling:
- Gracefully handles missing files
- Preserves partial data on failures
- Maintains data integrity</p>
<p>3. Extensibility:
- Easy to add new data sources
- Modular design for maintenance
- Consistent interface across datasets</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read all available datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_data</span> <span class="o">=</span> <span class="n">all_csv_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access specific datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disaster_data</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;disaster&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">forest_data</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;forest&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">futures_data</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;futures&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.disasters_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">disasters_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/Climate-related_Disasters_Frequency.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#disasters_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.disasters_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process climate-related disaster frequency data from a CSV file.</p>
<p>This function reads climate disaster data, processes it into a time series format,
and handles multiple disaster indicators across countries and years. It includes
comprehensive data transformation and pivoting to create a wide-format time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/Climate-related_Disasters_Frequency.csv&quot;</em>) – Path to the CSV file containing climate disaster frequency data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Columns named as ‘Indicator, ISO3 = XXX’ for each country
- Values representing disaster frequencies over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Transformation:</p>
<blockquote>
<div><ul class="simple">
<li><p>Melts year columns into a single date column</p></li>
<li><p>Pivots data to create indicator-country combinations</p></li>
<li><p>Preserves all disaster type classifications</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Date Handling:
- Extracts years from column names
- Converts to datetime format for consistency
- Creates annual time series structure</p></li>
<li><p>Column Organization:
- Combines indicator names with ISO3 codes
- Creates hierarchical column structure
- Maintains disaster type categorization</p></li>
<li><p>Data Quality:
- Handles missing values appropriately
- Preserves metadata from original file
- Maintains data relationships between indicators</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read disaster data from default file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disaster_data</span> <span class="o">=</span> <span class="n">disasters_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">disaster_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows disaster type-country combinations</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">disasters_readin</span><span class="p">(</span><span class="s2">&quot;path/to/disaster_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.energy_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">energy_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets\\MER_T02_01A.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#energy_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.energy_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process energy market data from a CSV file.</p>
<p>This function reads energy market data, processes it into a time series format,
and handles multiple energy indicators. It performs data cleaning and transformation
to create a structured time series dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>default=r&quot;datasetsMER_T02_01A.csv&quot;</em>) – Path to the CSV file containing energy market data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Energy market indicators as columns
- Values representing energy metrics over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Cleaning:</p>
<blockquote>
<div><ul class="simple">
<li><p>Removes unnecessary columns and whitespace</p></li>
<li><p>Handles missing values and special characters</p></li>
<li><p>Standardizes column names and formats</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Date Processing:
- Converts date strings to datetime objects
- Handles various date formats in input data
- Creates consistent time series index</p></li>
<li><p>Data Transformation:
- Pivots data for time series analysis
- Maintains data relationships
- Preserves original data granularity</p></li>
</ol>
<p>TODO: find better energy data set</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read energy data from default file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy_data</span> <span class="o">=</span> <span class="n">energy_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">energy_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows available energy indicators</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">energy_readin</span><span class="p">(</span><span class="s2">&quot;path/to/energy_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.forest_carbon_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">forest_carbon_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/Forest_and_Carbon.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#forest_carbon_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.forest_carbon_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process forest and carbon data from a CSV file.</p>
<p>This function reads forest and carbon-related data, processes it into a time series format,
and handles multiple indicators including carbon stocks, forest area, and related indices.
The function performs comprehensive data transformation to create a wide-format time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/Forest_and_Carbon.csv&quot;</em>) – Path to the CSV file containing forest and carbon data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Columns named as ‘Indicator, ISO3 = XXX’ for each country
- Values representing various forest and carbon metrics over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Organization:</p>
<blockquote>
<div><ul class="simple">
<li><p>Handles six main indicators:
* Carbon stocks in forests
* Forest area
* Index of carbon stocks in forests
* Index of forest extent
* Land area
* Share of forest area</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Data Transformation:
- Melts year columns into a single date column
- Pivots data to create indicator-country combinations
- Preserves all indicator classifications</p></li>
<li><p>Date Handling:
- Extracts years from column names
- Converts to datetime format for consistency
- Creates annual time series structure</p></li>
<li><p>Data Quality:
- Handles missing values appropriately
- Maintains relationships between indicators
- Preserves metadata from original file</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read forest and carbon data from default file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">forest_data</span> <span class="o">=</span> <span class="n">forest_carbon_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">forest_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows indicator-country combinations</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">forest_carbon_readin</span><span class="p">(</span><span class="s2">&quot;path/to/forest_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.futures_readin_bind">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">futures_readin_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/US</span> <span class="pre">Coffee</span> <span class="pre">C</span> <span class="pre">Futures</span> <span class="pre">Historical</span> <span class="pre">Data.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/US</span> <span class="pre">Coffee</span> <span class="pre">C</span> <span class="pre">Futures</span> <span class="pre">Historical</span> <span class="pre">Data(1).csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/US</span> <span class="pre">Coffee</span> <span class="pre">C</span> <span class="pre">Futures</span> <span class="pre">Historical</span> <span class="pre">Data(2).csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/US</span> <span class="pre">Coffee</span> <span class="pre">C</span> <span class="pre">Futures</span> <span class="pre">Historical</span> <span class="pre">Data(3).csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#futures_readin_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.futures_readin_bind" title="Link to this definition">¶</a></dt>
<dd><p>Read and combine multiple US Coffee C Futures historical data files.</p>
<p>This function reads multiple CSV files containing coffee futures data,
combines them into a single dataset, and processes them into a consistent
time series format. It handles data deduplication and ensures temporal continuity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file1</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/US Coffee C Futures Historical Data.csv&quot;</em>) – Path to the first CSV file containing futures data.</p></li>
<li><p><strong>file2</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/US Coffee C Futures Historical Data</em><em>(</em><em>1</em><em>)</em><em>.csv&quot;</em>) – Path to the second CSV file containing futures data.</p></li>
<li><p><strong>file3</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/US Coffee C Futures Historical Data</em><em>(</em><em>2</em><em>)</em><em>.csv&quot;</em>) – Path to the third CSV file containing futures data.</p></li>
<li><p><strong>file4</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/US Coffee C Futures Historical Data</em><em>(</em><em>3</em><em>)</em><em>.csv&quot;</em>) – Path to the fourth CSV file containing futures data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined and processed DataFrame with:
- ‘Date’ column in datetime format
- Standard futures trading metrics (Open, High, Low, Close, etc.)
- Consistent data format across all time periods</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Integration:</p>
<blockquote>
<div><ul class="simple">
<li><p>Combines multiple historical data files</p></li>
<li><p>Handles overlapping time periods</p></li>
<li><p>Maintains data consistency across sources</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Time Series Processing:
- Converts trading dates to datetime
- Creates continuous time series
- Handles market holidays and gaps</p></li>
<li><p>Data Standardization:
- Normalizes column names
- Standardizes data types
- Ensures consistent units</p></li>
<li><p>Quality Control:
- Removes duplicate entries
- Validates price data
- Ensures temporal ordering</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read futures data from default file locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">futures_data</span> <span class="o">=</span> <span class="n">futures_readin_bind</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">futures_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows available trading metrics</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">futures_readin_bind</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;path/to/file1.csv&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;path/to/file2.csv&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;path/to/file3.csv&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;path/to/file4.csv&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.human_development_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">human_development_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/HDR21-22_Composite_indices_complete_time_series.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#human_development_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.human_development_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process human development index (HDI) data from a CSV file.</p>
<p>This function reads HDI data from the UNDP Human Development Report dataset,
processes it into a time series format, and handles the complex structure
of HDI indicators across countries and years.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/HDR21-22_Composite_indices_complete_time_series.csv&quot;</em>) – Path to the CSV file containing HDI data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Columns named as ‘Indicator, ISO3 = XXX’ for each country
- Values representing HDI metrics over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Restructuring:</p>
<blockquote>
<div><ul class="simple">
<li><p>Melts wide-format data into long format for time series analysis</p></li>
<li><p>Groups data by ISO3 country codes and dates</p></li>
<li><p>Handles multiple HDI indicators per country</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Date Processing:
- Extracts year from column names
- Converts to datetime format for consistency
- Drops invalid dates to ensure data quality</p></li>
<li><p>Column Naming:
- Uses ISO3 country codes in column names
- Combines indicator names with country codes
- Creates consistent naming pattern for all metrics</p></li>
<li><p>Data Quality:
- Removes missing values
- Handles duplicate entries by taking first occurrence
- Preserves original indicator values</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read HDI data from default file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdi_data</span> <span class="o">=</span> <span class="n">human_development_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">hdi_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows indicator-country combinations</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">human_development_readin</span><span class="p">(</span><span class="s2">&quot;path/to/hdi_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="file_readin_functions.land_cover_readin">
<span class="sig-prename descclassname"><span class="pre">file_readin_functions.</span></span><span class="sig-name descname"><span class="pre">land_cover_readin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'datasets/Land_Cover_Accounts.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/file_readin_functions.html#land_cover_readin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#file_readin_functions.land_cover_readin" title="Link to this definition">¶</a></dt>
<dd><p>Read and process land cover account data from a CSV file.</p>
<p>This function reads land cover data, processes it into a time series format,
and handles multiple land cover indicators across countries and years. It includes
comprehensive data transformation to create a wide-format time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>default=&quot;datasets/Land_Cover_Accounts.csv&quot;</em>) – Path to the CSV file containing land cover account data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed DataFrame with:
- ‘Date’ column in datetime format
- Columns named as ‘Indicator, ISO3 = XXX’ for each country
- Values representing land cover metrics over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Transformation:</p>
<blockquote>
<div><ul class="simple">
<li><p>Melts year columns into a single date column</p></li>
<li><p>Pivots data to create indicator-country combinations</p></li>
<li><p>Preserves all land cover type classifications</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Date Handling:
- Extracts years from column names
- Converts to datetime format for consistency
- Creates annual time series structure</p></li>
<li><p>Column Organization:
- Combines indicator names with ISO3 codes
- Creates hierarchical column structure
- Maintains land cover type categorization</p></li>
<li><p>Data Quality:
- Handles missing values appropriately
- Preserves metadata from original file
- Maintains data relationships between indicators</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read land cover data from default file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">land_data</span> <span class="o">=</span> <span class="n">land_cover_readin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">land_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Shows land cover type-country combinations</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read from custom file location</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">land_cover_readin</span><span class="p">(</span><span class="s2">&quot;path/to/land_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-graph_visualization_functions">
<span id="graph-visualization-functions"></span><h2>Graph Visualization Functions<a class="headerlink" href="#module-graph_visualization_functions" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="graph_visualization_functions.plot_feature_correlations">
<span class="sig-prename descclassname"><span class="pre">graph_visualization_functions.</span></span><span class="sig-name descname"><span class="pre">plot_feature_correlations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Price'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(12,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'coolwarm'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/graph_visualization_functions.html#plot_feature_correlations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_visualization_functions.plot_feature_correlations" title="Link to this definition">¶</a></dt>
<dd><p>Plot correlation heatmap between features and target variable.</p>
<p>This function creates a correlation heatmap to visualize relationships
between features and the target variable, with special emphasis on
highlighting strong correlations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – DataFrame containing features and target variable.</p></li>
<li><p><strong>target_col</strong> (<em>str</em><em>, </em><em>default='Price'</em>) – Name of the target variable column.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>int</em><em>, </em><em>default=</em><em>(</em><em>12</em><em>, </em><em>8</em><em>)</em>) – Figure size in inches (width, height).</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>default='coolwarm'</em>) – Color map for the heatmap.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Visualization Layout:</p>
<blockquote>
<div><ul class="simple">
<li><p>Uses seaborn’s heatmap for clear correlation display</p></li>
<li><p>Implements symmetric color scheme around zero</p></li>
<li><p>Annotates correlation values for clarity</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Data Processing:
- Calculates Pearson correlation coefficients
- Handles missing values through pairwise deletion
- Orders features by correlation strength</p></li>
<li><p>Visual Elements:
- Rotates x-axis labels for readability
- Uses diverging color palette for intuitive interpretation
- Adds color bar for reference</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_feature_correlations</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># If not in interactive mode</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="graph_visualization_functions.plot_feature_importance">
<span class="sig-prename descclassname"><span class="pre">graph_visualization_functions.</span></span><span class="sig-name descname"><span class="pre">plot_feature_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_importance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(12,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'skyblue'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/graph_visualization_functions.html#plot_feature_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_visualization_functions.plot_feature_importance" title="Link to this definition">¶</a></dt>
<dd><p>Plot feature importance scores in a horizontal bar chart.</p>
<p>This function creates a visualization of feature importance scores,
showing the most influential features in predicting the target variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_importance</strong> (<em>dict</em>) – Dictionary mapping feature names to their importance scores.</p></li>
<li><p><strong>top_n</strong> (<em>int</em><em>, </em><em>default=20</em>) – Number of top features to display.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>int</em><em>, </em><em>default=</em><em>(</em><em>12</em><em>, </em><em>8</em><em>)</em>) – Figure size in inches (width, height).</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>default='skyblue'</em>) – Color for the bars in the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Visual Layout:</p>
<blockquote>
<div><ul class="simple">
<li><p>Horizontal bars for better feature name readability</p></li>
<li><p>Sorted by importance for clear ranking</p></li>
<li><p>Limited to top N features to prevent overcrowding</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Data Processing:
- Handles both absolute and relative importance scores
- Normalizes scores if needed
- Filters out features with zero importance</p></li>
<li><p>Customization:
- Configurable number of features to display
- Flexible color scheme
- Adjustable figure size</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample feature importance scores</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">importance</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature1&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature2&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature3&#39;</span><span class="p">:</span> <span class="mf">0.2</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_feature_importance</span><span class="p">(</span><span class="n">importance</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># If not in interactive mode</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="graph_visualization_functions.plot_time_series_decomposition">
<span class="sig-prename descclassname"><span class="pre">graph_visualization_functions.</span></span><span class="sig-name descname"><span class="pre">plot_time_series_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Price'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(15,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/graph_visualization_functions.html#plot_time_series_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_visualization_functions.plot_time_series_decomposition" title="Link to this definition">¶</a></dt>
<dd><p>Plot time series decomposition showing trend, seasonality, and residuals.</p>
<p>This function decomposes a time series into its components and creates
a visualization showing the original series, trend, seasonal pattern,
and residuals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – DataFrame containing time series data.</p></li>
<li><p><strong>date_col</strong> (<em>str</em><em>, </em><em>default='Date'</em>) – Name of the date column.</p></li>
<li><p><strong>value_col</strong> (<em>str</em><em>, </em><em>default='Price'</em>) – Name of the value column to decompose.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>int</em><em>, </em><em>default=</em><em>(</em><em>15</em><em>, </em><em>10</em><em>)</em>) – Figure size in inches (width, height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Decomposition Method:</p>
<blockquote>
<div><ul class="simple">
<li><p>Uses additive decomposition for price data</p></li>
<li><p>Handles missing values through interpolation</p></li>
<li><p>Preserves time series characteristics</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Visual Layout:
- Stacked subplots for clear component comparison
- Consistent x-axis scale across components
- Highlights seasonal patterns effectively</p></li>
<li><p>Data Processing:
- Ensures datetime format for dates
- Handles irregular time series through resampling
- Maintains data integrity during processing</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample time series data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_time_series_decomposition</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># If not in interactive mode</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-model_analysis_test_set">
<span id="model-analysis-test-set"></span><h2>Model Analysis Test Set<a class="headerlink" href="#module-model_analysis_test_set" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.analyze_accuracy_by_blocks">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">analyze_accuracy_by_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#analyze_accuracy_by_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.analyze_accuracy_by_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Analyze prediction accuracy across different blocks of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>merged_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing prediction results and actual values.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of blocks to divide the data into.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing block analysis results, with metrics for each time block
including directional accuracy percentages and average prediction errors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function segments the dataset into time-based blocks to analyze how
prediction accuracy varies across different periods. It helps identify
whether the model performs consistently over time or if there are specific
periods where performance deteriorates.</p>
<p>The function creates a visualization showing directional accuracy across
the time blocks and returns detailed metrics for further analysis.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.analyze_accuracy_by_price_range">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">analyze_accuracy_by_price_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#analyze_accuracy_by_price_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.analyze_accuracy_by_price_range" title="Link to this definition">¶</a></dt>
<dd><p>Analyze prediction accuracy across different price ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>merged_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing prediction results and actual values.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of price ranges to analyze.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing price range analysis results, with metrics for each
price range including directional accuracy percentages, price boundaries,
and average prediction errors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function segments the dataset into price-based ranges to analyze how
prediction accuracy varies across different price levels. It helps identify
whether the model performs consistently across all price ranges or if there
are specific price levels where performance is better or worse.</p>
<p>The function creates a visualization showing directional accuracy across
the price ranges and returns detailed metrics for further analysis. This
information can be valuable for understanding model limitations and potential
price-dependent biases.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.bland_altman_plot">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">bland_altman_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#bland_altman_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.bland_altman_plot" title="Link to this definition">¶</a></dt>
<dd><p>Creates a Bland-Altman plot comparing actual vs predicted prices,
with points colored by prediction horizon (days out).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence_size</strong> (<em>int</em>) – Integer representing the sequence size used in the model.</p></li>
<li><p><strong>forecast_results</strong> (<em>dict</em>) – Dictionary containing forecast results.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – DataFrame containing actual price data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays Bland-Altman plot using matplotlib.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Bland-Altman plot (or difference plot) is used to visualize the agreement
between two measurement methods. In this context, it shows the difference between
predicted and actual prices against their mean, providing insights into systematic
bias and limits of agreement.</p>
<p>Points are colored by forecast horizon (days out) to show how prediction
accuracy changes with increasing forecast distance. The function also prints
statistical information about mean difference and limits of agreement.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.calculate_directional_accuracy">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">calculate_directional_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#calculate_directional_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.calculate_directional_accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Calculate directional accuracy of predictions by forecast day and overall.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – DataFrame containing actual price data.</p></li>
<li><p><strong>forecast_results</strong> (<em>dict</em>) – Dictionary containing forecast results.</p></li>
<li><p><strong>sequence_size</strong> (<em>int</em>) – Integer representing the sequence size used in the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing accuracy metrics and detailed results:</p>
<ul class="simple">
<li><dl class="simple">
<dt>accuracy_by_day<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame with daily accuracy metrics.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>overall_accuracy<span class="classifier">float</span></dt><dd><p>Overall accuracy percentage.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detailed_metrics<span class="classifier">dict</span></dt><dd><p>Dictionary with additional performance metrics.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detailed_results<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame with prediction details.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the accuracy of predicted price directions (up or down)
compared to actual price movements. It performs analysis for each forecast day
and calculates aggregate metrics across all predictions.</p>
<p>The function creates a comprehensive set of metrics including:
- Direction prediction accuracy (overall and by day)
- Separate metrics for upward and downward movement predictions
- Error measurements (RMSE, MAPE)
- Direction bias analysis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.evaluate_test_set">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">evaluate_test_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#evaluate_test_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.evaluate_test_set" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate model performance on test set and generate predictions.</p>
<p>This function evaluates a trained model on test data, handling the conversion between
scaled and original values, and computing key performance metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained PyTorch model to evaluate.</p></li>
<li><p><strong>test_loader</strong> (<em>torch.utils.data.DataLoader</em>) – DataLoader containing the test dataset.</p></li>
<li><p><strong>scaler</strong> (<em>sklearn.preprocessing._data.StandardScaler</em>) – Fitted scaler object used to inverse transform predictions.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – Original test data containing all features. Used to determine feature dimensionality
and for date indexing.</p></li>
<li><p><strong>sequence_size</strong> (<em>int</em>) – The size of input sequences used during training.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to run evaluation on, by default ‘cuda’ if available else ‘cpu’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – predictions_original : Model predictions in original scale.</p></li>
<li><p><em>numpy.ndarray</em> – true_values_original : True values in original scale.</p></li>
<li><p><em>float</em> – rmse : Root Mean Square Error between predictions and true values.</p></li>
<li><p><em>pandas.DatetimeIndex</em> – dates : DatetimeIndex corresponding to the predictions.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. The function assumes the target variable is the last column in the dataset</p>
<blockquote>
<div><p>(excluding the index). This design choice simplifies the interface but requires
consistent data preprocessing.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Predictions are generated in batch mode for memory efficiency, especially
important for large test sets.</p></li>
<li><p>The scaler is applied to a zero-filled array with the same dimensionality
as the training data to ensure correct inverse transformation.</p></li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#model_analysis_test_set.plot_predictions" title="model_analysis_test_set.plot_predictions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_predictions</span></code></a></dt><dd><p>Function to visualize these predictions against true values.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">TransformerModel</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span><span class="p">,</span> <span class="n">true_values</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">dates</span> <span class="o">=</span> <span class="n">evaluate_test_set</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">sequence_size</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.plot_accuracy_metrics">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">plot_accuracy_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accuracy_by_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detailed_metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#plot_accuracy_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.plot_accuracy_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Create comprehensive visualization of accuracy metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy_by_day</strong> (<em>pandas.DataFrame</em>) – DataFrame containing accuracy metrics by day.</p></li>
<li><p><strong>detailed_metrics</strong> (<em>dict</em>) – Dictionary containing overall performance metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays visualization plots using matplotlib.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function creates a three-panel visualization showing:
1. Accuracy percentage by forecast day
2. Directional accuracy for upward vs downward movements
3. Average prediction error by day</p>
<p>The function also prints additional metrics including MAPE, RMSE,
and direction bias for comprehensive model evaluation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.plot_predictions">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">plot_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#plot_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.plot_predictions" title="Link to this definition">¶</a></dt>
<dd><p>Create comprehensive visualization of model predictions versus true values.</p>
<p>This function generates a two-panel plot showing both time series and regression
analysis of model predictions against true values. The visualization includes
statistical metrics and regression analysis to evaluate model performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>array-like</em>) – Model predictions in the original scale.</p></li>
<li><p><strong>true_values</strong> (<em>array-like</em>) – Actual values in the original scale.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – Test dataset containing the date index. Must have either a ‘Date’ column
or a DatetimeIndex.</p></li>
<li><p><strong>sequence_size</strong> (<em>int</em>) – The size of input sequences used during training, used for proper date alignment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Two-Panel Layout:</p>
<blockquote>
<div><ul class="simple">
<li><p>Top panel: Time series plot showing temporal patterns and divergences</p></li>
<li><p>Bottom panel: Regression plot with perfect prediction line for bias analysis</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Visual Elements:
- Uses alpha=0.5 for scatter plots to show point density
- Includes both regression line and perfect prediction line for comparison
- Grid enabled for better readability</p></li>
<li><p>Metrics Display:
- RMSE (Root Mean Square Error) for absolute error measurement
- MAE (Mean Absolute Error) for average deviation
- R² score for goodness of fit</p></li>
<li><p>Date Handling:
- Flexibly handles both ‘Date’ column and DatetimeIndex formats
- Adjusts for sequence_size to ensure proper temporal alignment</p></li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#model_analysis_test_set.evaluate_test_set" title="model_analysis_test_set.evaluate_test_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_test_set</span></code></a></dt><dd><p>Function that generates the predictions used by this visualization.</p>
</dd>
<dt><a class="reference internal" href="#model_analysis_test_set.plot_training_history" title="model_analysis_test_set.plot_training_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_training_history</span></code></a></dt><dd><p>Complementary function for visualizing training metrics.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">true_values</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">sequence_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># If not in interactive mode</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_analysis_test_set.plot_training_history">
<span class="sig-prename descclassname"><span class="pre">model_analysis_test_set.</span></span><span class="sig-name descname"><span class="pre">plot_training_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_analysis_test_set.html#plot_training_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_analysis_test_set.plot_training_history" title="Link to this definition">¶</a></dt>
<dd><p>Visualize training and validation loss history.</p>
<p>Creates a detailed visualization of model training progress, showing both training
and validation loss curves. Includes special handling for infinite values and
implements sophisticated styling for clear visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#time_series_transfomer.ModelTrainer" title="time_series_transfomer.ModelTrainer"><em>ModelTrainer</em></a>) – Trainer object containing training history. Must have the following attributes:
- validation_loss_history : list of float
- epoch_history : list of int
- training_loss_history : list of float</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – Figure size in inches (width, height), by default (10, 6)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Data Preprocessing:</p>
<blockquote>
<div><ul class="simple">
<li><p>Converts infinite values to NaN to prevent plotting issues</p></li>
<li><p>Maintains data integrity while handling numerical anomalies</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Visual Design:
- Implements markers for better epoch differentiation
- Customized line width and opacity for optimal readability</p></li>
<li><p>Plot Elements:
- Dual line plot showing both training and validation metrics
- Legend with appropriately sized fonts
- Grid lines for easier metric comparison
- Padding added to title for better spacing</p></li>
<li><p>Error Handling:
- Gracefully handles infinite values in loss histories
- Preserves plot functionality even with partial data corruption</p></li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#model_analysis_test_set.plot_predictions" title="model_analysis_test_set.plot_predictions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_predictions</span></code></a></dt><dd><p>Complementary function for visualizing model predictions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelTrainer</span></code></dt><dd><p>Class that generates the training history used here.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trainer</span> <span class="o">=</span> <span class="n">ModelTrainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># After training</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_training_history</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># If not in interactive mode</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-monte_carlo_sim_diagnostics">
<span id="monte-carlo-simulation-diagnostics"></span><h2>Monte Carlo Simulation Diagnostics<a class="headerlink" href="#module-monte_carlo_sim_diagnostics" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="monte_carlo_sim_diagnostics.MonteCarloPredictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monte_carlo_sim_diagnostics.</span></span><span class="sig-name descname"><span class="pre">MonteCarloPredictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_temp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim_diagnostics.html#MonteCarloPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim_diagnostics.MonteCarloPredictor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim_diagnostics.MonteCarloPredictor.plot_diagnostics">
<span class="sig-name descname"><span class="pre">plot_diagnostics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/monte_carlo_sim_diagnostics.html#MonteCarloPredictor.plot_diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim_diagnostics.MonteCarloPredictor.plot_diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Plot diagnostic visualizations using matplotlib</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim_diagnostics.MonteCarloPredictor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/monte_carlo_sim_diagnostics.html#MonteCarloPredictor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim_diagnostics.MonteCarloPredictor.predict" title="Link to this definition">¶</a></dt>
<dd><p>Run Monte Carlo prediction with diagnostics using data from a DataLoader</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim_diagnostics.MonteCarloPredictor.prediction_variance">
<span class="sig-name descname"><span class="pre">prediction_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/monte_carlo_sim_diagnostics.html#MonteCarloPredictor.prediction_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim_diagnostics.MonteCarloPredictor.prediction_variance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate rolling variance with safeguards</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-monte_carlo_sim">
<span id="monte-carlo-simulation"></span><h2>Monte Carlo Simulation<a class="headerlink" href="#module-monte_carlo_sim" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monte_carlo_sim.</span></span><span class="sig-name descname"><span class="pre">MonteCarloForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_temp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting">
<span class="sig-name descname"><span class="pre">monte_carlo_backtesting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_simulations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_start_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature_decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0.68,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster.monte_carlo_backtesting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting" title="Link to this definition">¶</a></dt>
<dd><p>Perform enhanced Monte Carlo backtesting with adaptive noise and confidence intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – DataFrame containing test data with ‘Price’ and feature columns.</p></li>
<li><p><strong>x_test</strong> (<em>torch.Tensor</em>) – Tensor of preprocessed test data sequences.</p></li>
<li><p><strong>forecast_horizon</strong> (<em>int</em><em>, </em><em>default=20</em>) – Number of days ahead to forecast for each simulation.</p></li>
<li><p><strong>num_simulations</strong> (<em>int</em><em>, </em><em>default=1000</em>) – Number of Monte Carlo simulations to run per starting point.
Minimum value is 30 for statistical significance.</p></li>
<li><p><strong>num_start_points</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of different starting points in the test set.
Minimum value is 10 for statistical significance.</p></li>
<li><p><strong>base_temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Initial temperature for noise generation.</p></li>
<li><p><strong>temperature_decay</strong> (<em>float</em><em>, </em><em>default=0.995</em>) – Factor to decay temperature over prediction horizon.</p></li>
<li><p><strong>min_temperature</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Minimum temperature floor for noise generation.</p></li>
<li><p><strong>confidence_levels</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>default=</em><em>[</em><em>0.68</em><em>, </em><em>0.95</em><em>]</em>) – Confidence levels for interval calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing backtesting results for each start point:
- predictions : numpy.ndarray</p>
<blockquote>
<div><p>Array of shape (num_iterations, num_days_to_predict)</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>mean<span class="classifier">numpy.ndarray</span></dt><dd><p>Mean prediction for each day</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>std<span class="classifier">numpy.ndarray</span></dt><dd><p>Standard deviation of predictions</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>start_date<span class="classifier">datetime</span></dt><dd><p>Starting date for this forecast</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>confidence_intervals<span class="classifier">dict</span></dt><dd><p>Confidence intervals at specified levels</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Statistical Requirements:
1. Minimum Sample Size:</p>
<blockquote>
<div><ul class="simple">
<li><p>At least 30 simulations per start point for reliable statistics</p></li>
<li><p>At least 10 start points for robust backtesting coverage</p></li>
<li><p>These minima ensure reliable confidence interval estimation</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Temperature Control:
- Base temperature controls initial prediction uncertainty
- Temperature decay reduces uncertainty over forecast horizon
- Minimum temperature prevents unrealistic stability</p></li>
<li><p>Implementation Details:
- Uses adaptive noise based on prediction variance
- Maintains temporal alignment with test data
- Preserves random state for reproducibility</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Long prediction horizons may accumulate errors</p></li>
<li><p>High num_iterations may impact performance</p></li>
<li><p>Confidence intervals assume normal distribution</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_plot" title="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">monte_carlo_backtesting_plot</span></code></a></dt><dd><p>Function to visualize these results</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">monte_carlo_backtesting_diagnostics_plot</span></code></dt><dd><p>Function for diagnostic analysis</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">MonteCarloForecaster</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">monte_carlo_backtesting</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_test</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_days_to_predict</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_iterations</span><span class="o">=</span><span class="mi">500</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean prediction horizon: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_diagnotsics_plot">
<span class="sig-name descname"><span class="pre">monte_carlo_backtesting_diagnotsics_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forecast_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster.monte_carlo_backtesting_diagnotsics_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_diagnotsics_plot" title="Link to this definition">¶</a></dt>
<dd><p>Generate diagnostic plots for Monte Carlo backtesting analysis.</p>
<p>This function creates a two-panel diagnostic visualization showing prediction
accuracy and error distribution patterns across the backtesting period.
Designed to help identify systematic biases and error patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast_results</strong> (<em>dict</em>) – Dictionary containing Monte Carlo simulation results from backtesting.
Must include mean predictions and confidence intervals.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – Original test dataset with actual prices in ‘Price’ column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Plot Layout:</p>
<blockquote>
<div><ul class="simple">
<li><p>Two-panel vertical arrangement (12, 10)</p></li>
<li><p>Top panel: Temporal error patterns</p></li>
<li><p>Bottom panel: Error distribution analysis</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Diagnostic Metrics:
- Day-wise prediction accuracy
- Error distribution characteristics
- Systematic bias indicators</p></li>
<li><p>Visual Elements:
- Clear color coding for error types
- Reference lines for perfect prediction
- Confidence bands for uncertainty</p></li>
<li><p>Analysis Features:
- Temporal clustering of errors
- Bias detection in predictions
- Outlier identification</p></li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting" title="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting"><code class="xref py py-obj docutils literal notranslate"><span class="pre">monte_carlo_backtesting</span></code></a></dt><dd><p>Function that generates the analyzed results</p>
</dd>
<dt><a class="reference internal" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_plot" title="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">monte_carlo_backtesting_plot</span></code></a></dt><dd><p>Main visualization of predictions</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">MonteCarloForecaster</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">monte_carlo_backtesting</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">x_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">monte_carlo_backtesting_diagnotsics_plot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">forecast_results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># If not in interactive mode</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_plot">
<span class="sig-name descname"><span class="pre">monte_carlo_backtesting_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backtesting_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_start_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">price_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Price'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Price</span> <span class="pre">Backtesting</span> <span class="pre">with</span> <span class="pre">Confidence</span> <span class="pre">Intervals'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster.monte_carlo_backtesting_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_plot" title="Link to this definition">¶</a></dt>
<dd><p>Create comprehensive visualization of Monte Carlo backtesting results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_test</strong> (<em>pandas.DataFrame</em>) – Preprocessed test data used for predictions.</p></li>
<li><p><strong>backtesting_results</strong> (<em>dict</em>) – Dictionary containing Monte Carlo simulation results from backtesting.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – Original test dataset with actual prices.</p></li>
<li><p><strong>forecast_horizon</strong> (<em>int</em><em>, </em><em>default=20</em>) – Number of days predicted in each forecast.</p></li>
<li><p><strong>num_start_points</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of forecast starting points used.</p></li>
<li><p><strong>confidence_colors</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Colors for confidence interval bands. Defaults to red-based palette.</p></li>
<li><p><strong>price_column</strong> (<em>str</em><em>, </em><em>default='Price'</em>) – Name of the price column in test_data.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>default='Price Backtesting with Confidence Intervals'</em>) – Plot title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Visual Layout:</p>
<blockquote>
<div><ul class="simple">
<li><p>Large figure size (15, 8) for detail visibility</p></li>
<li><p>Clear separation of actual vs predicted values</p></li>
<li><p>Multiple confidence intervals with transparency</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Visual Elements:
- Rainbow color scheme for different forecast periods
- Transparent confidence intervals (alpha=0.1)
- Historical mean reference line
- Clear date formatting and grid lines</p></li>
<li><p>Plot Components:
- Actual price line (blue)
- Individual forecast lines (rainbow colors)
- Confidence intervals (semi-transparent)
- Historical mean (dotted gray)</p></li>
<li><p>Layout Considerations:
- Large figure size (15x8) for detail visibility
- Rotated x-axis labels for readability
- Legend positioned outside plot
- Grid lines for value reference</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_pred_true_plot">
<span class="sig-name descname"><span class="pre">monte_carlo_backtesting_pred_true_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forecast_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster.monte_carlo_backtesting_pred_true_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_backtesting_pred_true_plot" title="Link to this definition">¶</a></dt>
<dd><p>Generate scatter plot comparing actual vs predicted prices from Monte Carlo backtesting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast_results</strong> (<em>dict</em>) – Dictionary containing Monte Carlo simulation results from backtesting.
Must contain mean predictions for each forecast start point.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – Original test dataset with actual prices in ‘Price’ column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the scatter plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function creates a scatter plot visualization that:</p>
<ol class="arabic simple">
<li><p>Compares actual prices against predicted prices</p></li>
<li><p>Color-codes points by forecast horizon (days out)</p></li>
<li><p>Includes a perfect prediction reference line</p></li>
<li><p>Uses a color gradient to show how prediction accuracy changes with forecast distance</p></li>
</ol>
<p>The plot helps identify systematic biases in the model predictions and visualize
how prediction accuracy varies across different price levels and forecast horizons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster.monte_carlo_forecast">
<span class="sig-name descname"><span class="pre">monte_carlo_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_days_to_predict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.68,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster.monte_carlo_forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_forecast" title="Link to this definition">¶</a></dt>
<dd><p>Enhanced Monte Carlo simulation for price forecasting with adaptive noise and multiple confidence intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_test</strong> (<em>torch.Tensor</em>) – Input test data tensor containing feature sequences.</p></li>
<li><p><strong>num_days_to_predict</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of days to forecast into the future.</p></li>
<li><p><strong>num_iterations</strong> (<em>int</em><em>, </em><em>default=1000</em>) – Number of Monte Carlo simulations to run.</p></li>
<li><p><strong>base_temp</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Initial temperature for noise generation.</p></li>
<li><p><strong>decay_factor</strong> (<em>float</em><em>, </em><em>default=0.995</em>) – Factor to decay temperature over time (0-1).</p></li>
<li><p><strong>min_temp</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Minimum temperature floor for noise generation.</p></li>
<li><p><strong>confidence_levels</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>default=</em><em>[</em><em>0.68</em><em>, </em><em>0.95</em><em>]</em>) – List of confidence levels to calculate (e.g., [0.68, 0.95] for 1σ and 2σ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing forecast results with columns:
- Date : Forecast dates
- Mean_Prediction : Average prediction for each date
- Std_Prediction : Standard deviation of predictions
- Confidence_Interval_X.XX_lower : Lower bound for each confidence level
- Confidence_Interval_X.XX_upper : Upper bound for each confidence level</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method implements a sophisticated Monte Carlo approach to time series
forecasting by:</p>
<ol class="arabic simple">
<li><p>Running multiple simulations with randomized noise</p></li>
<li><p>Using adaptive noise levels based on recent prediction variance</p></li>
<li><p>Calculating multiple confidence intervals for uncertainty quantification</p></li>
<li><p>Converting scaled predictions back to the original price scale</p></li>
</ol>
<p>The method maintains seed values for reproducibility(not that pytorch is allowing reproducability with CUDA for performance reasons if you don’t have a b100).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monte_carlo_sim.MonteCarloForecaster.monte_carlo_forecast_plot">
<span class="sig-name descname"><span class="pre">monte_carlo_forecast_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">remaining_days_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DateMax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">price_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Price'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Price</span> <span class="pre">Forecast</span> <span class="pre">with</span> <span class="pre">Confidence</span> <span class="pre">Intervals'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#MonteCarloForecaster.monte_carlo_forecast_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.MonteCarloForecaster.monte_carlo_forecast_plot" title="Link to this definition">¶</a></dt>
<dd><p>Enhanced plotting function for forecasting results with flexible confidence intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>remaining_days_data</strong> (<em>pandas.DataFrame</em>) – DataFrame containing future predictions and confidence intervals.</p></li>
<li><p><strong>predictions</strong> (<em>pandas.DataFrame</em>) – DataFrame containing model predictions for historical data.</p></li>
<li><p><strong>test_data</strong> (<em>pandas.DataFrame</em>) – Original test dataset containing actual price values.</p></li>
<li><p><strong>DateMax</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of future dates to plot.</p></li>
<li><p><strong>confidence_colors</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – List of colors for confidence intervals. Defaults to red-based palette.</p></li>
<li><p><strong>price_column</strong> (<em>str</em><em>, </em><em>default='Price'</em>) – Name of the price column in test_data.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>default='Price Forecast with Confidence Intervals'</em>) – Plot title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib’s pyplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function creates a comprehensive visualization that includes:</p>
<ol class="arabic simple">
<li><p>Historical actual prices</p></li>
<li><p>Historical model predictions</p></li>
<li><p>Future forecasted prices with multiple confidence intervals</p></li>
<li><p>Historical mean price reference line</p></li>
</ol>
<p>The visualization employs a customized color scheme for clarity and uses
transparent confidence intervals to show prediction uncertainty. The function
handles both date-indexed and date-columned DataFrames appropriately.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monte_carlo_sim.calculate_dynamic_temperature">
<span class="sig-prename descclassname"><span class="pre">monte_carlo_sim.</span></span><span class="sig-name descname"><span class="pre">calculate_dynamic_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recent_predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">market_volatility_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volatility_impact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#calculate_dynamic_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.calculate_dynamic_temperature" title="Link to this definition">¶</a></dt>
<dd><p>Calculate dynamic temperature for Monte Carlo simulation based on recent market volatility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recent_predictions</strong> (<em>list</em>) – List of recent price predictions.</p></li>
<li><p><strong>day</strong> (<em>int</em>) – Current forecast day.</p></li>
<li><p><strong>base_temp</strong> (<em>float</em>) – Base temperature value.</p></li>
<li><p><strong>decay_factor</strong> (<em>float</em>) – Rate at which temperature decays over time (0-1).</p></li>
<li><p><strong>min_temp</strong> (<em>float</em>) – Minimum allowed temperature.</p></li>
<li><p><strong>market_volatility_window</strong> (<em>int</em><em>, </em><em>default=5</em>) – Number of recent predictions to consider for volatility.</p></li>
<li><p><strong>volatility_impact</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Scaling factor for how much volatility affects temperature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dynamic temperature value used for noise generation in simulations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function implements an adaptive approach to noise generation in Monte Carlo
simulations by considering both time decay and market volatility. The temperature:</p>
<ol class="arabic simple">
<li><p>Decays exponentially over time (forecast horizon)</p></li>
<li><p>Increases with market volatility</p></li>
<li><p>Has a guaranteed minimum value</p></li>
</ol>
<p>This approach helps maintain prediction diversity while adapting to changing
market conditions and reducing noise as the forecast extends further into the future.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monte_carlo_sim.create_day_out_dict">
<span class="sig-prename descclassname"><span class="pre">monte_carlo_sim.</span></span><span class="sig-name descname"><span class="pre">create_day_out_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accuracy_plot_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test_filtered</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#create_day_out_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.create_day_out_dict" title="Link to this definition">¶</a></dt>
<dd><p>Create a dictionary of DataFrames where each DataFrame contains data for a specific day_out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy_plot_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing predictions.</p></li>
<li><p><strong>y_test_filtered</strong> (<em>pandas.DataFrame</em>) – DataFrame containing actual values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with day_out as keys and DataFrames as values.
Each DataFrame contains merged prediction and actual data for a specific forecast horizon.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function organizes backtesting results by forecast horizon (‘day_out’),
allowing for separate analysis of prediction accuracy at different time distances.
The resulting dictionary enables detailed evaluation of how model performance
changes as predictions extend further into the future.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monte_carlo_sim.prediction_variance">
<span class="sig-prename descclassname"><span class="pre">monte_carlo_sim.</span></span><span class="sig-name descname"><span class="pre">prediction_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/monte_carlo_sim.html#prediction_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monte_carlo_sim.prediction_variance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate rolling variance for recent predictions with safeguards for small windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>array-like</em>) – Array of recent price predictions.</p></li>
<li><p><strong>window</strong> (<em>int</em><em>, </em><em>default=5</em>) – Size of the rolling window for variance calculation.</p></li>
<li><p><strong>base_temp</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Base temperature/variance to use when insufficient data is available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Calculated variance scaled by base_temp, or default value if
insufficient data is available.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is designed to provide adaptive variance estimation for
Monte Carlo simulations. It handles edge cases like empty arrays or
arrays smaller than the specified window by returning sensible defaults.</p>
<p>The variance is scaled by base_temp to maintain appropriate noise levels
in the simulation.</p>
</dd></dl>

</section>
<section id="module-time_series_transfomer">
<span id="time-series-transformer"></span><h2>Time Series Transformer<a class="headerlink" href="#module-time_series_transfomer" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">AdaptiveForecastLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">historical_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_max_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_range_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_change_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>DEPRECATED severly broken
Advanced loss function that incorporates multi-step forecasting and learnable parameters
for dynamic adaptation to market conditions.</p>
<p>This loss function:
1. Performs multi-step forecasting within the loss calculation
2. Uses learnable parameters to adapt penalties
3. Implements dynamic scaling based on forecast horizon
4. Combines multiple objectives with adaptive weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>historical_range</strong> (<em>tuple</em>) – (min_price, max_price) from historical data</p></li>
<li><p><strong>forecast_steps</strong> (<em>int</em><em>, </em><em>default=5</em>) – Number of future steps to consider in forecasting component</p></li>
<li><p><strong>init_max_change</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Initial value for maximum daily change parameter</p></li>
<li><p><strong>init_range_weight</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Initial weight for range violation penalty</p></li>
<li><p><strong>init_change_weight</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Initial weight for change violation penalty</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss.adaptive_change_penalty">
<span class="sig-name descname"><span class="pre">adaptive_change_penalty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss.adaptive_change_penalty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss.adaptive_change_penalty" title="Link to this definition">¶</a></dt>
<dd><p>Calculate adaptive change penalty with increasing allowance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss.adaptive_range_penalty">
<span class="sig-name descname"><span class="pre">adaptive_range_penalty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss.adaptive_range_penalty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss.adaptive_range_penalty" title="Link to this definition">¶</a></dt>
<dd><p>Calculate adaptive range violation penalty with increasing bounds</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss.forecast_loss">
<span class="sig-name descname"><span class="pre">forecast_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss.forecast_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss.forecast_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculate loss across multiple forecast steps with increasing uncertainty</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculate total loss with natural uncertainty growth</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss.momentum_continuity">
<span class="sig-name descname"><span class="pre">momentum_continuity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss.momentum_continuity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss.momentum_continuity" title="Link to this definition">¶</a></dt>
<dd><p>Calculate momentum with increasing flexibility</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AdaptiveForecastLoss.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AdaptiveForecastLoss.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AdaptiveForecastLoss.to" title="Link to this definition">¶</a></dt>
<dd><p>Override to method to handle device placement for all tensors</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.AsymptotePreventionLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">AsymptotePreventionLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">historical_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_daily_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AsymptotePreventionLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AsymptotePreventionLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Loss function specifically designed to prevent asymptote convergence by:
1. Penalizing predictions that deviate too far from the historical range
2. Encouraging price movement continuation
3. Maintaining realistic price changes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>historical_range</strong> (<em>tuple</em>) – (min_price, max_price) from historical data</p></li>
<li><p><strong>max_daily_change</strong> (<em>float</em>) – Maximum allowed daily price change as a percentage</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.AsymptotePreventionLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#AsymptotePreventionLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.AsymptotePreventionLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.CustomLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">CustomLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#CustomLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.CustomLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Custom loss function for time series forecasting that combines multiple objectives:
1. MSE for basic prediction accuracy
2. Trend preservation loss to maintain price movement direction
3. Volatility matching loss to maintain price variation patterns
4. Momentum preservation loss to prevent asymptote convergence</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>default=0.4</em>) – Weight for trend preservation loss</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Weight for volatility matching loss</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Weight for momentum preservation loss</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.CustomLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#CustomLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.CustomLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.DirectionalLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">DirectionalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mse_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#DirectionalLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.DirectionalLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A simple loss function that combines MSE with cosine similarity to ensure
predictions follow the correct directional trend.</p>
<p>This loss function:
1. Uses normalized MSE (bounded between 0 and 1) for point-wise accuracy
2. Uses cosine similarity to ensure directional alignment
3. Combines both metrics with a weighted sum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction_weight</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Weight given to the directional (cosine) component of the loss.
The MSE component will have weight (1 - direction_weight).</p></li>
<li><p><strong>mse_scale</strong> (<em>float</em><em>, </em><em>default=10.0</em>) – Scale factor for MSE normalization. Higher values make the sigmoid
transition sharper around smaller MSE values.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.DirectionalLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#DirectionalLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.DirectionalLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.ForecastBasedLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">ForecastBasedLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mse_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volatility_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ForecastBasedLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ForecastBasedLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Enhanced loss function that combines:
1. Directional accuracy using cosine similarity
2. Bounded MSE for point accuracy
3. Volatility matching for realistic price movements
4. Uncertainty-weighted multi-step forecasting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#time_series_transfomer.TransformerModel" title="time_series_transfomer.TransformerModel"><em>TransformerModel</em></a>) – The model being trained, used to generate forecasts</p></li>
<li><p><strong>forecast_steps</strong> (<em>int</em><em>, </em><em>default=5</em>) – Number of steps to forecast for loss calculation</p></li>
<li><p><strong>forecast_weight</strong> (<em>float</em><em>, </em><em>default=0.4</em>) – Weight given to forecast-based loss vs immediate prediction loss</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Temperature for forecast uncertainty</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of Monte Carlo samples for each forecast</p></li>
<li><p><strong>mse_scale</strong> (<em>float</em><em>, </em><em>default=10.0</em>) – Scale factor for MSE normalization in sigmoid</p></li>
<li><p><strong>direction_weight</strong> (<em>float</em><em>, </em><em>default=0.4</em>) – Weight for directional component in forecast evaluation</p></li>
<li><p><strong>volatility_weight</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Weight for volatility matching component</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ForecastBasedLoss.calculate_step_losses">
<span class="sig-name descname"><span class="pre">calculate_step_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ForecastBasedLoss.calculate_step_losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ForecastBasedLoss.calculate_step_losses" title="Link to this definition">¶</a></dt>
<dd><p>Calculate all loss components for a single prediction step.
All components are bounded between 0 and 1 using sigmoid for equal weighting.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ForecastBasedLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ForecastBasedLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ForecastBasedLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculate combined loss using immediate predictions and generated forecasts.
All components are sigmoid-bounded and properly weighted.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ForecastBasedLoss.generate_forecast_sequence">
<span class="sig-name descname"><span class="pre">generate_forecast_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_sequences</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ForecastBasedLoss.generate_forecast_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ForecastBasedLoss.generate_forecast_sequence" title="Link to this definition">¶</a></dt>
<dd><p>Generate forecasts for each sequence in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_sequences</strong> (<em>torch.Tensor</em>) – Batch of input sequences [batch_size, seq_length, features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(forecasts, forecast_stds) where:
- forecasts: tensor of shape [batch_size, forecast_steps]
- forecast_stds: tensor of shape [batch_size, forecast_steps]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">ModelTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A comprehensive trainer class for time series forecasting models with PyTorch.</p>
<p>This class manages the complete training lifecycle of deep learning models, including:
- Model training with customizable loss functions
- Validation and early stopping
- Learning rate scheduling
- Model evaluation
- Forecasting with uncertainty quantification
- Experiment logging and model checkpointing</p>
<p>The trainer supports various loss functions optimized for time series forecasting:
- MSE (default)
- Custom weighted loss
- Asymptote prevention loss
- Adaptive forecast loss</p>
<p>Features:
- Automatic early stopping based on validation loss
- Learning rate scheduling with ReduceLROnPlateau
- Monte Carlo sampling for uncertainty quantification in forecasts
- Experiment tracking and logging
- Model checkpointing and best model saving
- Comprehensive training history tracking</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The PyTorch model to train (typically a TransformerModel instance).</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to use for training (CPU or CUDA).</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>default=1e-4</em>) – Initial learning rate for the AdamW optimizer.</p></li>
<li><p><strong>model_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration dictionary for model architecture and parameters.
Used for experiment logging and reproducibility.</p></li>
<li><p><strong>logger</strong> (<a class="reference internal" href="#time_series_transfomer.ModelTuningLogger" title="time_series_transfomer.ModelTuningLogger"><em>ModelTuningLogger</em></a><em>, </em><em>optional</em>) – Logger instance for tracking experiments and saving results.
If provided, will log training metrics, validation results,
and model configurations.</p></li>
<li><p><strong>loss_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>Configuration for the loss function. Should contain:
- ‘type’: str, one of [‘mse’, ‘custom’, ‘asymptote_prevention’, ‘adaptive_forecast’]
- Additional parameters specific to each loss type:</p>
<blockquote>
<div><ul>
<li><p>custom: {‘alpha’, ‘beta’, ‘gamma’}</p></li>
<li><p>asymptote_prevention: {‘historical_range’, ‘max_daily_change’}</p></li>
<li><dl class="simple">
<dt>adaptive_forecast: {‘historical_range’, ‘forecast_steps’, ‘init_max_change’,</dt><dd><p>’init_range_weight’, ‘init_change_weight’}</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.validation_loss_history">
<span class="sig-name descname"><span class="pre">validation_loss_history</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.validation_loss_history" title="Link to this definition">¶</a></dt>
<dd><p>History of validation losses during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.training_loss_history">
<span class="sig-name descname"><span class="pre">training_loss_history</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.training_loss_history" title="Link to this definition">¶</a></dt>
<dd><p>History of training losses during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.epoch_history">
<span class="sig-name descname"><span class="pre">epoch_history</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.epoch_history" title="Link to this definition">¶</a></dt>
<dd><p>List of completed epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.lr_history">
<span class="sig-name descname"><span class="pre">lr_history</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.lr_history" title="Link to this definition">¶</a></dt>
<dd><p>History of learning rates during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.optimizer" title="Link to this definition">¶</a></dt>
<dd><p>The optimizer instance with weight decay.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.optim.AdamW</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.scheduler">
<span class="sig-name descname"><span class="pre">scheduler</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.scheduler" title="Link to this definition">¶</a></dt>
<dd><p>Learning rate scheduler that reduces LR on plateau.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.optim.lr_scheduler.ReduceLROnPlateau</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.criterion">
<span class="sig-name descname"><span class="pre">criterion</span></span><a class="headerlink" href="#time_series_transfomer.ModelTrainer.criterion" title="Link to this definition">¶</a></dt>
<dd><p>The loss function based on loss_config.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'models'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer.train" title="Link to this definition">¶</a></dt>
<dd><p>Main training loop with early stopping and checkpointing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.train_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer.train_epoch" title="Link to this definition">¶</a></dt>
<dd><p>Trains the model for one epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer.validate" title="Link to this definition">¶</a></dt>
<dd><p>Validates the model on validation data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the model on test data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer.forecast" title="Link to this definition">¶</a></dt>
<dd><p>Generates probabilistic forecasts with uncertainty quantification.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the model on test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_loader</strong> (<em>torch.utils.data.DataLoader</em>) – DataLoader containing test data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing test metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd><p>Generate forecasts using the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_sequence</strong> (<em>torch.Tensor</em><em> or </em><em>numpy.ndarray</em>) – Initial sequence to start forecasting from</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) – Number of steps to forecast into the future</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Base temperature for uncertainty in predictions</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of Monte Carlo samples to generate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing forecast results:
- ‘mean’: Mean predictions
- ‘std’: Standard deviation of predictions
- ‘samples’: All Monte Carlo samples if num_samples &gt; 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method handles converting the initial sequence to the correct format
and device, then uses the model’s generate_forecast method to produce
predictions with uncertainty quantification.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTrainer.get_available_loss_functions">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_available_loss_functions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.get_available_loss_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTrainer.get_available_loss_functions" title="Link to this definition">¶</a></dt>
<dd><p>Get information about available loss functions and their parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing loss function descriptions and required parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'models'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd><p>Train the model with early stopping and learning rate scheduling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loaders</strong> (<em>dict</em>) – Dictionary containing DataLoader objects for ‘train’ and ‘val’.</p></li>
<li><p><strong>epochs</strong> (<em>int</em><em>, </em><em>default=1000</em>) – Maximum number of epochs to train.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which training will be stopped.</p></li>
<li><p><strong>model_dir</strong> (<em>str</em><em>, </em><em>default='models'</em>) – Directory to save trained models.</p></li>
<li><p><strong>experiment_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name for the experiment. Used in the saved model filename.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing training history.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.train_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition">¶</a></dt>
<dd><p>Train the model for one epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>train_loader</strong> (<em>torch.utils.data.DataLoader</em>) – DataLoader containing training data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average training loss for the epoch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTrainer.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the model on validation data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val_loader</strong> (<em>torch.utils.data.DataLoader</em>) – DataLoader containing validation data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average validation loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">ModelTuningLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTuningLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Logger for tracking model configurations and performance metrics during tuning.</p>
<p>This class handles saving and loading experiment results, including model
configurations, training history, and validation performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_dir</strong> (<em>str</em><em>, </em><em>default='logs'</em>) – Directory to save experiment logs.</p></li>
<li><p><strong>experiment_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the experiment. If None, a timestamp will be used.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.log_dir">
<span class="sig-name descname"><span class="pre">log_dir</span></span><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.log_dir" title="Link to this definition">¶</a></dt>
<dd><p>Path to the log directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.experiment_name">
<span class="sig-name descname"><span class="pre">experiment_name</span></span><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.experiment_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of the current experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.results">
<span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.results" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary to store experiment results.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.get_best_config">
<span class="sig-name descname"><span class="pre">get_best_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTuningLogger.get_best_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.get_best_config" title="Link to this definition">¶</a></dt>
<dd><p>Get the best configuration based on a specific metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default='val_loss'</em>) – Metric to use for comparison.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default='min'</em>) – ‘min’ for metrics where lower is better (e.g., loss),
‘max’ for metrics where higher is better (e.g., accuracy).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(config_id, config_dict) of the best configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.load_results">
<span class="sig-name descname"><span class="pre">load_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTuningLogger.load_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.load_results" title="Link to this definition">¶</a></dt>
<dd><p>Load experiment results from a JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the JSON file. If None, uses the current experiment name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing loaded experiment results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.log_experiment">
<span class="sig-name descname"><span class="pre">log_experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTuningLogger.log_experiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.log_experiment" title="Link to this definition">¶</a></dt>
<dd><p>Log experiment details and results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_config</strong> (<em>dict</em>) – Dictionary containing model configuration parameters.</p></li>
<li><p><strong>training_history</strong> (<em>dict</em>) – Dictionary containing training history (losses, epochs, etc.).</p></li>
<li><p><strong>val_metrics</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing validation metrics.</p></li>
<li><p><strong>test_metrics</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing test metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the saved JSON file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.ModelTuningLogger.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#ModelTuningLogger.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.ModelTuningLogger.save_results" title="Link to this definition">¶</a></dt>
<dd><p>Save all experiment results to a JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the saved JSON file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.PositionalEncoding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">PositionalEncoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#PositionalEncoding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.PositionalEncoding" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implements positional encoding for Transformer models.</p>
<p>This module adds positional information to the input embeddings for sequence models,
allowing the model to leverage sequence order information despite the parallelized
nature of Transformer architectures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_model</strong> (<em>int</em>) – Dimension of the model’s embeddings.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate to apply after adding positional encodings.</p></li>
<li><p><strong>max_len</strong> (<em>int</em><em>, </em><em>default=5000</em>) – Maximum sequence length the model can handle.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<section id="implementation-details">
<h3>1. Implementation Details<a class="headerlink" href="#implementation-details" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>1.1. Sinusoidal Encoding</dt><dd><ul class="simple">
<li><p>Uses sine and cosine functions of different frequencies for position encoding</p></li>
<li><p>Position enc(pos, 2i) = sin(pos/10000^(2i/d_model))</p></li>
<li><p>Position enc(pos, 2i+1) = cos(pos/10000^(2i/d_model))</p></li>
</ul>
</dd>
<dt>1.2. Benefits</dt><dd><ul class="simple">
<li><p>Allows model to generalize to sequence lengths not seen during training</p></li>
<li><p>Provides consistent relative position information</p></li>
<li><p>Enables the model to capture sequential patterns and dependencies</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create positional encoding for embedding dimension 512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_encoder</span> <span class="o">=</span> <span class="n">PositionalEncoding</span><span class="p">(</span><span class="n">d_model</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to an input tensor of shape [sequence_length, batch_size, embedding_dim]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>  <span class="c1"># [seq_len, batch, d_model]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">pos_encoder</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.PositionalEncoding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#PositionalEncoding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.PositionalEncoding.forward" title="Link to this definition">¶</a></dt>
<dd><p>Add positional encoding to input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape [seq_len, batch_size, d_model]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor with added positional encodings, same shape as input</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">TimeSeriesDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">365</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#TimeSeriesDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for preparing and processing time series data for deep learning models.</p>
<p>This class handles data preparation, scaling, and sequence creation for time series
forecasting tasks. It creates train, validation, and test splits and returns them
as PyTorch DataLoader objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sequence_size</strong> (<em>int</em><em>, </em><em>default=365</em>) – The length of each input sequence used for prediction.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset.sequence_size">
<span class="sig-name descname"><span class="pre">sequence_size</span></span><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset.sequence_size" title="Link to this definition">¶</a></dt>
<dd><p>The length of each input sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset.scaler">
<span class="sig-name descname"><span class="pre">scaler</span></span><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset.scaler" title="Link to this definition">¶</a></dt>
<dd><p>Scaler used to standardize features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sklearn.preprocessing.StandardScaler</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset.x_test">
<span class="sig-name descname"><span class="pre">x_test</span></span><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset.x_test" title="Link to this definition">¶</a></dt>
<dd><p>The test input sequences after processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset.test_data">
<span class="sig-name descname"><span class="pre">test_data</span></span><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset.test_data" title="Link to this definition">¶</a></dt>
<dd><p>The raw test data split.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset.num_features">
<span class="sig-name descname"><span class="pre">num_features</span></span><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset.num_features" title="Link to this definition">¶</a></dt>
<dd><p>The number of features in the processed dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<section id="data-processing-flow">
<h3>1. Data Processing Flow<a class="headerlink" href="#data-processing-flow" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>1.1. Data Preparation</dt><dd><ul class="simple">
<li><p>Handles splitting data into train, validation, and test sets</p></li>
<li><p>Performs standardization of all features</p></li>
<li><p>Creates sequence batches for time series modeling</p></li>
</ul>
</dd>
<dt>1.2. Data Validation</dt><dd><ul class="simple">
<li><p>Performs checks for empty datasets after splitting</p></li>
<li><p>Validates data dimensions throughout the processing pipeline</p></li>
</ul>
</dd>
<dt>1.3. Sequence Creation</dt><dd><ul class="simple">
<li><p>Converts raw data into overlapping sequences of specified length</p></li>
<li><p>Each sequence becomes an input sample, with the next value as target</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load time series data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stock_data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create dataset object with sequence length 30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDataset</span><span class="p">(</span><span class="n">sequence_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Prepare data with 80% training, 20% validation split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataloaders</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">train_split</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">val_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access the prepared data loaders</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">dataloaders</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val_loader</span> <span class="o">=</span> <span class="n">dataloaders</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_loader</span> <span class="o">=</span> <span class="n">dataloaders</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.TimeSeriesDataset.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#TimeSeriesDataset.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.TimeSeriesDataset.prepare_data" title="Link to this definition">¶</a></dt>
<dd><p>Prepare time series data for model training and evaluation.</p>
<p>This method handles data splitting, scaling, and sequence creation.
It splits the data into train, validation, and test sets, scales the
features, and creates overlapping sequences for time series prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – Input time series data with a ‘Date’ column and feature columns.</p></li>
<li><p><strong>train_split</strong> (<em>float</em><em>, </em><em>default=0.8</em>) – Proportion of data to use for training (0.0 to 1.0).</p></li>
<li><p><strong>val_split</strong> (<em>float</em><em>, </em><em>default=0.8</em>) – Proportion of training data to use for validation (0.0 to 1.0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing DataLoader objects for ‘train’, ‘val’, and ‘test’ sets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the resulting datasets are empty after splitting.</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="time_series_transfomer.TransformerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">TransformerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#TransformerModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.TransformerModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Transformer-based model for time series forecasting.</p>
<p>This model uses a Transformer encoder architecture to process multivariate
time series data and predict future values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<em>int</em>) – Number of input features.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=512</em>) – Dimension of the model embeddings and transformer layers.</p></li>
<li><p><strong>nhead</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in transformer layers.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em><em>, </em><em>default=2</em>) – Number of transformer encoder layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate used throughout the model.</p></li>
<li><p><strong>decoder_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the decoder network. If None, a default decoder is used.
Expected keys:
- hidden_layers: list of tuples (size, activation)
- use_batch_norm: bool
- dropout: float</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<section id="architecture-components">
<h3>1. Architecture Components<a class="headerlink" href="#architecture-components" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>1.1. Input Encoding</dt><dd><ul class="simple">
<li><p>Linear projection from input features to model dimension</p></li>
<li><p>Positional encoding to preserve sequence order information</p></li>
</ul>
</dd>
<dt>1.2. Transformer Encoder</dt><dd><ul class="simple">
<li><p>Multi-head self-attention mechanism</p></li>
<li><p>Feedforward neural networks</p></li>
<li><p>Layer normalization and residual connections</p></li>
</ul>
</dd>
<dt>1.3. Output Decoder</dt><dd><ul class="simple">
<li><p>Multi-layer feedforward neural network</p></li>
<li><p>Progressively reduces dimensions to final output</p></li>
</ul>
</dd>
</dl>
</section>
<section id="prediction-process">
<h3>2. Prediction Process<a class="headerlink" href="#prediction-process" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>2.1. Feature Encoding</dt><dd><ul class="simple">
<li><p>Each timestep’s features are encoded to the model dimension</p></li>
</ul>
</dd>
<dt>2.2. Sequence Processing</dt><dd><ul class="simple">
<li><p>Transformer layers process the entire sequence in parallel</p></li>
<li><p>Self-attention captures dependencies between different timesteps</p></li>
</ul>
</dd>
<dt>2.3. Prediction Generation</dt><dd><ul class="simple">
<li><p>The final timestep representation is used for prediction</p></li>
<li><p>Decoder network produces the final output value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a transformer model for time series with 5 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">TransformerModel</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">nhead</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Process a batch of 32 sequences, each with 100 timesteps and 5 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># [batch_size, seq_length, features]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>  <span class="c1"># Shape: [batch_size, 1]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.TransformerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#TransformerModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.TransformerModel.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass through the transformer model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape [batch_size, seq_length, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor of shape [batch_size, 1] containing predictions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="time_series_transfomer.TransformerModel.generate_forecast">
<span class="sig-name descname"><span class="pre">generate_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#TransformerModel.generate_forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.TransformerModel.generate_forecast" title="Link to this definition">¶</a></dt>
<dd><p>Generate multi-step forecasts with uncertainty quantification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_sequence</strong> (<em>torch.Tensor</em>) – Initial sequence of shape [1, sequence_length, num_features]</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) – Number of steps to forecast into the future</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Base temperature for uncertainty. Higher values = more uncertainty</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of Monte Carlo samples to generate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing:
- ‘mean’: Mean predictions for each future step
- ‘std’: Standard deviation of predictions
- ‘samples’: All Monte Carlo samples if num_samples &gt; 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="time_series_transfomer.create_decoder_grid">
<span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">create_decoder_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#create_decoder_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.create_decoder_grid" title="Link to this definition">¶</a></dt>
<dd><p>Create a grid of decoder configurations for hyperparameter tuning.</p>
<p>This function generates a comprehensive set of decoder architectures by varying
layer widths, activation functions, batch normalization, and dropout rates.
The configurations are designed specifically for time series forecasting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=512</em>) – Dimension of the transformer model’s embeddings. This value is used to scale
the decoder layer widths proportionally.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>List of decoder configurations. Each dictionary contains:</p>
<ul class="simple">
<li><dl class="simple">
<dt>hidden_layers<span class="classifier">list of tuples (size, activation)</span></dt><dd><p>Layer architecture with sizes and activation types</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>use_batch_norm<span class="classifier">bool</span></dt><dd><p>Whether to use batch normalization between layers</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dropout<span class="classifier">float</span></dt><dd><p>Dropout rate to apply between hidden layers</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="time_series_transfomer.run_decoder_tuning">
<span class="sig-prename descclassname"><span class="pre">time_series_transfomer.</span></span><span class="sig-name descname"><span class="pre">run_decoder_tuning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mse'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/time_series_transfomer.html#run_decoder_tuning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#time_series_transfomer.run_decoder_tuning" title="Link to this definition">¶</a></dt>
<dd><p>Run comprehensive hyperparameter tuning for decoder architectures.</p>
<p>This function performs systematic evaluation of different decoder configurations
for transformer models. It handles the complete tuning process including
data preparation, model creation, training, evaluation, and result logging.
It implements checkpointing to handle interruptions gracefully.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – Input time series data with features and a ‘Date’ column.</p></li>
<li><p><strong>sequence_size</strong> (<em>int</em><em>, </em><em>default=30</em>) – Length of input sequences for the model.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=512</em>) – Dimension of the transformer model’s embeddings.</p></li>
<li><p><strong>nhead</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in transformer layers.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em><em>, </em><em>default=7</em>) – Number of transformer encoder layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for transformer layers.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>default=1e-4</em>) – Initial learning rate for optimization.</p></li>
<li><p><strong>epochs</strong> (<em>int</em><em>, </em><em>default=50</em>) – Maximum number of training epochs per configuration.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs without improvement before early stopping.</p></li>
<li><p><strong>plot_training</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to plot training history after each configuration trains.</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>default='custom'</em>) – Type of loss function to use:
- ‘custom’: Uses CustomLoss with trend, volatility, and momentum preservation
- ‘asymptote_prevention’: Uses AsymptotePreventionLoss to prevent convergence
- ‘forecast_based’: Uses ForecastBasedLoss to evaluate prediction quality using forecasts
- ‘mse’: Uses standard MSE loss</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing:</p>
<ul class="simple">
<li><dl class="simple">
<dt>experiment_path<span class="classifier">str</span></dt><dd><p>Path to the experiment directory</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>top_models<span class="classifier">list</span></dt><dd><p>List of the 5 best performing model configurations and their metrics</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Experimental Design:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Directory Structure</dt><dd><ul class="simple">
<li><p>Creates timestamped experiment directories</p></li>
<li><p>Maintains separate directories for models and logs</p></li>
<li><p>Saves checkpoints for interruption recovery</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Model Selection</dt><dd><ul class="simple">
<li><p>Uses min-heap to track top 5 performing models based on training loss</p></li>
<li><p>Saves both model states and configurations for later use</p></li>
<li><p>All floating-point values are rounded to 4 decimal places</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Performance Optimization</dt><dd><ul class="simple">
<li><p>Implements early stopping for efficient training</p></li>
<li><p>Uses GPU acceleration when available</p></li>
<li><p>Manages memory through periodic cleanup</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</dd></dl>

</section>
<section id="module-utility_functions">
<span id="utility-functions"></span><h2>Utility Functions<a class="headerlink" href="#module-utility_functions" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utility_functions.concat_all_data">
<span class="sig-prename descclassname"><span class="pre">utility_functions.</span></span><span class="sig-name descname"><span class="pre">concat_all_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utility_functions.html#concat_all_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utility_functions.concat_all_data" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate and align multiple time series DataFrames with consistent frequency.</p>
<p>This function combines multiple time series DataFrames while handling frequency
conversion, missing values, and temporal alignment. It supports both daily and
monthly data frequencies and includes optional NaN indicators for tracking missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict</em>) – Dictionary of DataFrames to concatenate. Must include a ‘futures’ key with
its corresponding DataFrame. Each DataFrame must have a ‘Date’ column.</p></li>
<li><p><strong>is_monthly</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, treats and resamples data as monthly frequency (MS = Month Start).
If False, treats and resamples data as daily frequency.</p></li>
<li><p><strong>track_nans</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, creates indicator columns for NaN values in the original data.
If False, only forward fills missing values without tracking.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A concatenated DataFrame containing all features from input DataFrames with:
- Consistent date frequency (daily or monthly)
- Optional NaN indicators for missing values (if track_nans=True)
- Forward-filled missing data
- Deduplicated column names
- Chronologically sorted rows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Date Handling:</p>
<blockquote>
<div><ul class="simple">
<li><p>Uses futures data date range as reference</p></li>
<li><p>Converts all dates to datetime format</p></li>
<li><p>Sets monthly dates to first of month when applicable</p></li>
<li><p>Creates consistent date index across all data</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Missing Data Strategy:
- Optional creation of indicator columns for original NaN values
- Forward fills missing values for continuity
- Handles both temporal and feature-wise missing data
- Preserves information about data availability when track_nans=True</p></li>
<li><p>Data Alignment:
- Uses futures data as anchor for date range
- Resamples all other data to match frequency
- Handles overlapping and non-overlapping periods
- Maintains temporal ordering</p></li>
<li><p>Column Management:
- Adds suffixes to resolve duplicate column names
- Preserves original column names where possible
- Creates intuitive names for NaN indicators when track_nans=True
- Ensures unique column identifiers</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Forward filling may create artificial continuity</p></li>
<li><p>When track_nans=False, information about original missing values is lost</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#utility_functions.transform_futures_data" title="utility_functions.transform_futures_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_futures_data</span></code></a></dt><dd><p>Function for preprocessing futures data</p>
</dd>
<dt><a class="reference internal" href="#utility_functions.fix_column_order" title="utility_functions.fix_column_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_column_order</span></code></a></dt><dd><p>Function for standardizing column order</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utility_functions.concat_all_data_yearly_old">
<span class="sig-prename descclassname"><span class="pre">utility_functions.</span></span><span class="sig-name descname"><span class="pre">concat_all_data_yearly_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utility_functions.html#concat_all_data_yearly_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utility_functions.concat_all_data_yearly_old" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate multiple time series DataFrames with daily frequency (deprecated).</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span>This function is deprecated and will be removed in version 2.0.0.
Use <a class="reference internal" href="#utility_functions.concat_all_data" title="utility_functions.concat_all_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">concat_all_data()</span></code></a> with is_monthly=False instead.</p>
</div>
<p>This function processes multiple time series DataFrames, converting them to
daily frequency and concatenating them horizontally. It handles missing values,
date alignment, and column name conflicts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – Dictionary of DataFrames where keys are dataset names and values are
the corresponding DataFrames. Each DataFrame must have a ‘Date’ column.
The dictionary must contain a ‘futures’ key with its associated DataFrame.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A concatenated DataFrame containing all features from input DataFrames with:
- Daily frequency
- NaN indicators for missing values
- Forward-filled missing data
- Deduplicated column names
- Chronologically sorted rows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Date Processing:</p>
<blockquote>
<div><ul class="simple">
<li><p>Uses futures data date range as reference</p></li>
<li><p>Converts all dates to datetime format</p></li>
<li><p>Creates daily frequency index for all data</p></li>
<li><p>Maintains temporal ordering</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Missing Data Handling:
- Creates indicator columns for original NaN values
- Forward fills missing values for continuity
- Preserves information about data availability</p></li>
<li><p>Data Alignment:
- Uses futures data as anchor for date range
- Resamples all other data to daily frequency
- Handles overlapping and non-overlapping periods</p></li>
<li><p>Column Management:
- Adds suffixes to resolve duplicate column names
- Preserves original column names where possible
- Creates intuitive names for NaN indicators</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This function is deprecated and will be removed in version 2.0.0</p></li>
<li><p>Forward filling may create artificial continuity</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#utility_functions.concat_all_data" title="utility_functions.concat_all_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">concat_all_data</span></code></a></dt><dd><p>Newer function that handles both daily and monthly data</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">futures_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-02&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;futures&#39;</span><span class="p">:</span> <span class="n">futures_df</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">:</span> <span class="n">other_df</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">concat_all_data_yearly_old</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utility_functions.convert_to_serializable">
<span class="sig-prename descclassname"><span class="pre">utility_functions.</span></span><span class="sig-name descname"><span class="pre">convert_to_serializable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utility_functions.html#convert_to_serializable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utility_functions.convert_to_serializable" title="Link to this definition">¶</a></dt>
<dd><p>Convert NumPy types to Python native types for JSON serialization.</p>
<p>This function recursively converts NumPy data types to their Python native
equivalents to make them JSON serializable. It handles integers, floats,
arrays, and nested structures like dictionaries and lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>any</em>) – The object to convert, which may contain NumPy data types.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted object with all NumPy types replaced with Python native types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>any</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Handles the following NumPy types:
- Integer types (int8, int16, int32, int64, etc.) → Python int
- Float types (float16, float32, float64) → Python float
- NumPy arrays → Python lists
- Nested dictionaries and lists are processed recursively</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">42</span><span class="p">),</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">serializable_data</span> <span class="o">=</span> <span class="n">convert_to_serializable</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">serializable_data</span><span class="p">)</span>  <span class="c1"># This will succeed</span>
<span class="go">&#39;{&quot;value&quot;: 42, &quot;array&quot;: [1, 2, 3]}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utility_functions.country_name_to_iso3">
<span class="sig-prename descclassname"><span class="pre">utility_functions.</span></span><span class="sig-name descname"><span class="pre">country_name_to_iso3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">country_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utility_functions.html#country_name_to_iso3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utility_functions.country_name_to_iso3" title="Link to this definition">¶</a></dt>
<dd><p>Convert a country or region name to its ISO 3166-1 alpha-3 code or custom temporary code.</p>
<p>This function handles both standard country names and special regional/economic
groupings that don’t have official ISO codes. It uses a custom mapping for
non-standard entities and falls back to fuzzy matching for standard country names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>country_name</strong> (<em>str</em>) – The name of the country or region to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The three-letter ISO code (for countries) or custom temporary code (for regions).
Returns None if no matching code is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Custom Mapping:</p>
<blockquote>
<div><ul class="simple">
<li><p>Uses temporary codes (XXXXTMP) for non-standard entities</p></li>
<li><p>Based on common UN file conventions for regional groupings</p></li>
<li><p>Preserves official ISO codes where they exist (e.g., “BOL” for Bolivia)</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Fallback Strategy:
- Primary lookup in custom iso3_mapping dictionary
- Secondary fuzzy search using pycountry for standard countries
- Returns None instead of raising exceptions for unmatched names</p></li>
<li><p>Code Structure:
- Three-letter codes for consistency with ISO 3166-1
- TMP suffix indicates non-standard/temporary codes
- Regional codes follow logical abbreviation patterns</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Standard country</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">country_name_to_iso3</span><span class="p">(</span><span class="s2">&quot;France&quot;</span><span class="p">)</span>
<span class="go">&#39;FRA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Regional grouping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">country_name_to_iso3</span><span class="p">(</span><span class="s2">&quot;Advanced Economies&quot;</span><span class="p">)</span>
<span class="go">&#39;AETMP&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-existent country</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">country_name_to_iso3</span><span class="p">(</span><span class="s2">&quot;NonExistentLand&quot;</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utility_functions.fix_column_order">
<span class="sig-prename descclassname"><span class="pre">utility_functions.</span></span><span class="sig-name descname"><span class="pre">fix_column_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utility_functions.html#fix_column_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utility_functions.fix_column_order" title="Link to this definition">¶</a></dt>
<dd><p>Standardize column order in time series DataFrames with ‘Date’ first and ‘Price’ last.</p>
<p>This function ensures a consistent column order across time series DataFrames,
placing the ‘Date’ column first and the price-related column last. It handles
both daily and monthly data formats, with special handling for monthly price
column naming and optional NaN tracking columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing time series data with ‘Date’ and price columns.</p></li>
<li><p><strong>monthly_data</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, handles monthly data where ‘Price_mean’ might be used instead of ‘Price’.</p></li>
<li><p><strong>track_nans</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, preserves _was_nan columns next to their corresponding feature columns.
If False, removes all _was_nan columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with standardized column order: [‘Date’, …, ‘Price’].
If track_nans=True, _was_nan columns will be placed immediately after their
corresponding feature columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Column Ordering:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘Date’ column always comes first for temporal reference</p></li>
<li><p>Feature columns in the middle maintain their relative order</p></li>
<li><p>Price column always comes last for consistency</p></li>
<li><p>NaN indicator columns are placed immediately after their features</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Price Column Handling:
- For daily data: Uses ‘Price’ column name
- For monthly data: Converts ‘Price_mean’ to ‘Price’ if present
- Maintains original column if no renaming is needed</p></li>
<li><p>Data Preservation:
- Creates a copy to avoid modifying the input DataFrame
- Preserves all original data, only changes column order
- Maintains data types of all columns</p></li>
<li><p>NaN Tracking:
- When track_nans=True, preserves _was_nan columns next to their features
- When track_nans=False, removes all _was_nan columns
- Maintains feature-NaN indicator pairs when tracking is enabled</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Daily data example with NaN tracking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_daily</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature1_was_nan&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-02&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fix_column_order</span><span class="p">(</span><span class="n">df_daily</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="go">[&#39;Date&#39;, &#39;Feature1&#39;, &#39;Feature1_was_nan&#39;, &#39;Price&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Monthly data example without NaN tracking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_monthly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Feature1_was_nan&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-02-01&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Price_mean&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fix_column_order</span><span class="p">(</span><span class="n">df_monthly</span><span class="p">,</span> <span class="n">monthly_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="go">[&#39;Date&#39;, &#39;Feature1&#39;, &#39;Price&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utility_functions.transform_futures_data">
<span class="sig-prename descclassname"><span class="pre">utility_functions.</span></span><span class="sig-name descname"><span class="pre">transform_futures_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframes_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utility_functions.html#transform_futures_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utility_functions.transform_futures_data" title="Link to this definition">¶</a></dt>
<dd><p>Transform futures data to include comprehensive monthly statistics and indicators.</p>
<p>This function processes raw futures data to create a rich set of monthly
statistics and technical indicators. It handles data aggregation, volatility
calculation, and various price-based metrics while ensuring proper date handling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataframes_dict</strong> (<em>dict</em>) – Dictionary containing dataframes, must include a ‘futures’ key with
corresponding DataFrame containing columns: Date, High, Low, Price,
Open, Vol., Change %.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated dictionary with transformed futures data, where the ‘futures’
DataFrame now contains monthly statistics including:
- High_max, Low_min : Highest high and lowest low for the month
- Price_mean, Price_median, Price_min, Price_max : Price statistics
- Open_mean, Vol._mean, Change %_mean : Averaged values
- Price_pct_change : Month-over-month price change percentage
- Price_volatility : Standard deviation of daily returns
- Price_range_pct : Monthly price range as percentage of mean</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Design Decisions:
1. Date Handling:</p>
<blockquote>
<div><ul class="simple">
<li><p>Converts all dates to datetime format for consistency</p></li>
<li><p>Sets dates to first of month for proper alignment</p></li>
<li><p>Maintains chronological order in output</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Statistical Calculations:
- Uses multiple price points (High, Low, Open) for comprehensive analysis
- Calculates both simple statistics and derived metrics
- Preserves original data while adding new insights</p></li>
<li><p>Performance Considerations:
- Creates copy of input dictionary to prevent modification
- Uses efficient pandas operations for calculations
- Groups operations to minimize data traversal</p></li>
<li><p>Data Quality:
- Handles missing values implicitly through aggregation
- Maintains data types throughout transformation
- Ensures consistent column naming</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample futures data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">futures_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-02&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;High&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Low&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Open&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Vol.&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1100</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;Change %&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;futures&#39;</span><span class="p">:</span> <span class="n">futures_df</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformed</span> <span class="o">=</span> <span class="n">transform_futures_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">transformed</span><span class="p">[</span><span class="s1">&#39;futures&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<p>This section will contain the API reference for CoffeeGPT. Add details here when available.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">CoffeeGPT</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-feature_selection">Feature Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-file_readin_functions">File Read-in Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-graph_visualization_functions">Graph Visualization Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-model_analysis_test_set">Model Analysis Test Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-monte_carlo_sim_diagnostics">Monte Carlo Simulation Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-monte_carlo_sim">Monte Carlo Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-time_series_transfomer">Time Series Transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utility_functions">Utility Functions</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, John Hohman.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/api_reference.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>